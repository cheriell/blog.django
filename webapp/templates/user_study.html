{% extends "base.html" %}
{% block page %}

<script src="../static/js/check.js"></script>

{% if status_on %}
    <h1><strong><center>User Study</center></strong></h1>

    <form name="user-study" action="/thanks/" onsubmit="return validateForm()" method='POST'>
    {% csrf_token %}
        <br>
        <h3><strong>1. Listen and Rate</strong></h3>

        Below you will be given a list of audio segments. Some of the pieces have their accompaniments generated automatically by different music accompaniment systems. For all of the given segments, we will ask you to rate how well you feel about the automatic generated part fits the given melody. Please listen to the following music pieces and give your evaluation by ratings.

        {% for segment in segments %}
        <br><br>
        <strong>Music Segment {{ segment.no }}</strong>
        <br><br>
        <p>Below are five accompaiments generated by different models. On a scale of 1-10 (1: very bad, 10: excellent), how would you rate the quality of the provided accompaniments? Note: you may hear only the melody for some parts of the pieces, this means the accompaniment contains a lot of rests.</p>
            {% for suffix in suffixes %}
            <div class="row">
                <div class="col-sm-6">
                    <center>
                        <audio controls class="myaudio">
                            <source src="../static/audio/{{ segment.name }}.{{ suffix.value }}.mp3" stype="audio/mpeg" />
                            <source src="../static/audio/{{ segment.name }}.{{ suffix.value }}.ogg" stype="audio/ogg" />
                        Your browser does not support this audio format, view source <a href="../static/audio/{{ segment.name }}.{{ suffix.value }}.mp3" target="_blank">here</a>.
                        </audio>
                    </center>
                </div>
                <div class="col-sm-6">
                    Your rating: 
                    <select class="myselect" style="padding-left:35px" name="rating{{ segment.no }}_{{ suffix.no }}">
                        {% for rating_value in rating_values %}
                            {% if rating_value.value == 0 %}
                            <option value="{{ rating_value.value }}">--</option>
                            {% else %}
                            <option value="{{ rating_value.value }}">{{ rating_value.value }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
            </div>
            {% endfor %}
        {% endfor %}

        <br><br>
        <h3><strong>2. General Questions</strong></h3>

        (a) Below are the music segments automatically generated by our developed automatic accompaniment system you listened in the previous "Listen and Rate" section. You can re-listen to the music pieces. Do you have any comments on the automatic generated music pieces? Can you specify some crucial weakness present in the automaic accompaniment system?

        <div class="row">
        {% for segment in segments %}
            <div class="col-sm-6">
                {% if segment.left == 'true' %}
                <center>
                {% endif %}
                    <audio controls class="myaudio">
                        <source src="../static/audio/{{ segment.name }}.chroma-based.mp3" stype="audio/mpeg" />
                        <source src="../static/audio/{{ segment.name }}.chroma-based.ogg" stype="audio/ogg" />
                    Your browser does not support this audio format, see it <a href="../static/audio/{{ segment.name }}.chroma-based.mp3" target="_blank">here</a>.
                    </audio>
                {% if segment.left == 'true' %}
                </center>
                {% endif %}
            </div>
        {% endfor %}
        </div>
        <textarea type="text" rows="3" class="mytextarea" name="general_a" maxlength="10000"></textarea>

        <br><br>
        (b) Do you think the automatic accompaniment system can give a reasonable starting point for musicians/non-musicians who want to write music?
        <br>
        <textarea type="text" rows="3" class="mytextarea" name="general_b" maxlength="10000"></textarea>

        <br><br>
        (c) Do you have any other comments on our study?
        <br>
        <textarea type="text" rows="3" class="mytextarea" name="general_c" maxlength="10000"></textarea>

        <br><br>
        <h3><strong>3. Participant Information</strong></h3>

        * Years of musical training:
        <br>
        <textarea type="text" rows="1" class="mytextarea" style="width:100px;margin:0 0 0 0;" name="years_musical_training" maxlength="10"></textarea>
        <br>
        * Which music style do you most closely identify with (in terms of your musical practice)?
        <br>
        <select class="myselect" style="width:500px;padding:0 0.5em 0 0.5em" name="music_style">
            {% for music_style in music_styles %}
            <option value="{{ music_style.value }}">{{ music_style.value }}</option>
            {% endfor %}
        </select>
        <br>
        * Your name:
        <br>
        <textarea type="text" rows="1" class="mytextarea" style="width:500px;margin:0 0 0 0" name="name" maxlength="100"></textarea>
        <br>

        <br><br>
        <button type="submit" class="btn btn-default mybutton">
            <strong>Submit</strong>
        </button>
    </form>
{% else %}
    <h1><strong><center>User Study on Automatic Music Accompaniment</center></strong></h1>
    <br><br>
    <strong>Thanks for your interest, this study is finished.</strong>

    <br><br><br><br><br><br><br><br><br><br><br>
    <h3><strong>For More Information</strong></h3>
    <br>
    You can visit <a href="https://www.qmul.ac.uk/privacy/" target="_blank"><strong>Queen Mary's privacy notice</strong></a> for research participants for important information about your personal data and your rights in this respect.

    <br><br>
    If you have any questions or concerns about the manner in which the study was conducted please, in the first instance, please contact me at lele.liu@se13.qmul.ac.uk.
    <br><br>
    If this is unsuccessful, or not appropriate, please contact the Secretary at the Queen Mary Ethics of Research Committee, Room W104, Queens’ Building, Mile End Campus, Mile End Road, London, E1 4NS or research-ethics@qmul.ac.uk.
    <br><br>
    If you have any questions relating to data protection, please contact Data Protection Officer, Queens’ Building, Mile End Road, London, E1 4NS or data-protection@qmul.ac.uk
    <br><br>
    <img src="../static/img/QMUL-logo.gif" style="width:300px">
{% endif %}


{% endblock %}

